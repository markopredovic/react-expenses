(this["webpackJsonpreact-expenses"]=this["webpackJsonpreact-expenses"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),l=n.n(c),o=(n(85),n(7)),u=n(15),s=n(24),i=(n(91),n(135)),p=n(136),m=n(134),E=n(74),f=n(6),d=n.n(f),b=n(10),v=n(19),h=n(65),g=n.n(h),O=n(27),y=n(66),w=n(67),j=n(78);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={token:null,user:null,expenses:[],filter:{month:(new Date).getMonth(),year:(new Date).getFullYear()}},k=function(e,t){return D({},e,{token:t.jwt,user:t.user})},S=function(e){return D({},e,{token:null,user:null,expenses:[]})},N=function(e,t){return D({},e,{filter:{month:parseInt(t.month),year:parseInt(t.year)}})},L=function(e,t){var n=e.expenses.filter((function(e){return e.id!==t}));return D({},e,{expenses:n})},I=function(e,t){return D({},e,{expenses:t})},_=function(e,t){return D({},e,{expenses:[].concat(Object(j.a)(e.expenses),[t])})},C=Object(O.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGGED_IN":return k(e,t.payload);case"USER_LOGGED_OUT":return S(e);case"FILTER_UPDATE":return N(e,t.payload);case"EXPENSE_DELETED":return L(e,t.payload);case"GET_EXPENSES_LIST":return I(e,t.payload);case"EXPENSE_ADDED":return _(e,t.payload);default:return e}}),Object(w.composeWithDevTools)(Object(O.applyMiddleware)(y.a)));function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=g.a.create({baseURL:"http://localhost:1337",timeout:1e3}),F=function(){var e=C.getState().token;U.interceptors.request.use((function(t){return e&&(t.headers=T({},t.headers,{Authorization:"Bearer ".concat(e)})),t}),(function(e){return Promise.reject(e)}))},A={login:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.post("/auth/local",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),register:function(e){try{return U.post("/auth/local/register",e)}catch(t){throw new Error(t.message)}},getExpenses:function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,F(),e.next=4,U.get("/expenses");case 4:return t=e.sent,e.abrupt("return",t.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),addExpense:function(e){try{return F(),U.post("/expenses",e)}catch(t){throw new Error(t.message)}},deleteExpense:function(e){try{return U.delete("/expenses/".concat(e))}catch(t){throw new Error(t.message)}}},R=function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.login(e);case 3:a=t.sent,n(H(a)),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error("Unable to login");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},H=function(e){return{type:"USER_LOGGED_IN",payload:{jwt:e.jwt,user:e.user}}},M=function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.deleteExpense(e);case 3:a=t.sent,n(X(a.data.id)),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},X=function(e){return{type:"EXPENSE_DELETED",payload:e}},J=function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.register(e);case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),new Error(t.t0.response.data.message[0].messages[0].message);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()},B=function(e){return{type:"GET_EXPENSES_LIST",payload:e}},q=function(e){return{type:"EXPENSE_ADDED",payload:e}},W=function(){var e=Object(s.f)(),t=Object(o.b)(),n=Object(o.c)((function(e){return!!e.token}));return r.a.createElement("header",{className:"mb-5"},r.a.createElement(i.a,{bg:"dark",variant:"dark",expand:"lg"},r.a.createElement("div",{className:"container"},r.a.createElement(i.a.Brand,{as:u.b,to:"/"},"Expenses"),r.a.createElement(i.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(i.a.Collapse,{id:"basic-navbar-nav",className:"justify-content-end"},r.a.createElement(p.a,null,n?r.a.createElement(m.a,{title:"Dashboard",id:"dashboard"},r.a.createElement(m.a.Item,{as:u.b,to:"/expenses",exact:!0},"Expenses"),r.a.createElement(m.a.Item,{as:u.b,to:"/expenses/new",exact:!0},"Add expense"),r.a.createElement(m.a.Divider,null),r.a.createElement(m.a.Item,{as:E.a,onClick:function(){t({type:"USER_LOGGED_OUT"}),e.push("/")}},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a.Link,{as:u.b,to:"/register"},"Signup"),r.a.createElement(p.a.Link,{as:u.b,to:"/login"},"Login")))))))},Y=function(){return r.a.createElement("footer",null,r.a.createElement("div",{className:"fixed-bottom py-2 text-center bg-dark text-white"},"Developed by"," ",r.a.createElement("a",{href:"https://markoni.codes",className:"text-warning"},"markoni.codes")))},z=function(e){var t=e.children;return r.a.createElement("main",null,r.a.createElement("div",{className:"container"},t))},$=function(e){var t=e.title;return r.a.createElement("h3",{className:"mb-4"},t)},K=function(){return r.a.createElement(z,null,r.a.createElement($,{title:"Home"}))},Q=n(13),V=n(75),Z=n(137),ee=n(132),te=n(77),ne=function(e){e.id;var t=e.title,n=e.amount,a=e.expense_date,c=e.deleteExpense;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("span",{className:""},t)),r.a.createElement("td",null,r.a.createElement("span",{className:""},n.toFixed(2))),r.a.createElement("td",null,r.a.createElement("span",{className:""},new Date(a).toLocaleDateString("sr-SR"))),r.a.createElement("td",null,r.a.createElement("span",{className:"expense-delete text-danger",onClick:c},r.a.createElement(te.a,null))))},ae=n(133),re=function(e){var t=e.currentFilter,n=e.updateFilter,c=Object(a.useRef)(null),l=Object(a.useRef)(null);Object(a.useEffect)((function(){c.current.value=t.month,l.current.value=t.year}),[t]);return r.a.createElement(ae.a,{className:"d-flex align-items-end mb-3",onSubmit:function(e){e.preventDefault();var t={month:c.current.value,year:l.current.value};n(t)}},r.a.createElement(ae.a.Group,{controlId:"filter.month",className:"mr-3 mb-0"},r.a.createElement(ae.a.Label,null,"Month:"),r.a.createElement(ae.a.Control,{as:"select",ref:c},r.a.createElement("option",{value:"0"},"Jan"),r.a.createElement("option",{value:"1"},"Feb"),r.a.createElement("option",{value:"2"},"Mar"),r.a.createElement("option",{value:"3"},"Apr"),r.a.createElement("option",{value:"4"},"May"),r.a.createElement("option",{value:"5"},"Jun"),r.a.createElement("option",{value:"6"},"Jul"),r.a.createElement("option",{value:"7"},"Aug"),r.a.createElement("option",{value:"8"},"Sep"),r.a.createElement("option",{value:"9"},"Oct"),r.a.createElement("option",{value:"10"},"Nov"),r.a.createElement("option",{value:"11"},"Dec"))),r.a.createElement(ae.a.Group,{controlId:"filter.year",className:"mr-3 mb-0"},r.a.createElement(ae.a.Label,null,"Year:"),r.a.createElement(ae.a.Control,{as:"select",ref:l},r.a.createElement("option",{value:"2019"},"2019"),r.a.createElement("option",{value:"2020"},"2020"),r.a.createElement("option",{value:"2021"},"2021"),r.a.createElement("option",{value:"2022"},"2022"),r.a.createElement("option",{value:"2023"},"2023"))),r.a.createElement(E.a,{variant:"primary",type:"submit"},"Filter"))},ce=function(){var e=Object(o.b)(),t=Object(s.f)(),n=Object(a.useState)(!1),c=Object(Q.a)(n,2),l=c[0],u=c[1],i=Object(o.c)((function(e){return!!e.token}));Object(a.useEffect)((function(){i?e(function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.getExpenses();case 3:n=e.sent,t(B(n)),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()):t.push("/")}),[]);var p=Object(o.c)((function(e){var t=e.filter;return t.month||t.year?e.expenses.filter((function(e){var n=function(e){var t=new Date(e);return[t.getMonth(),t.getFullYear()]}(e.expense_date),a=Object(Q.a)(n,2),r=a[0],c=a[1];return t.month&&t.year?r===t.month&&c===t.year:!t.month&&t.year?c===t.year:!t.year&&t.month?r===t.month:null})):e.expenses})),m=Object(o.c)((function(e){return e.filter})),E=p.length>0?p.reduce((function(e,t){return e+t.amount}),0):0,f=p.map((function(e){return r.a.createElement(ne,Object.assign({key:e.id},e,{deleteExpense:function(){return v(e.id)}}))})),v=function(){var t=Object(b.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,u(!1),t.next=4,e(M(n));case 4:u(!0),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("main",null,r.a.createElement("div",{className:"container"},r.a.createElement(re,{currentFilter:m,updateFilter:function(t){u(!1),e(function(e){return{type:"FILTER_UPDATE",payload:e}}(t))}}),!!l&&r.a.createElement(Z.a,{variant:"danger"},"Expense Deleted"),p.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(V.Scrollbars,{autoHeight:!0,autoHeightMin:10,autoHeightMax:310},r.a.createElement(ee.a,{responsive:!0,hover:!0,striped:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Amount"),r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"DEL"))),r.a.createElement("tbody",null,f))),r.a.createElement("div",{className:"mt-3"},"Total: ",r.a.createElement("strong",null,E.toFixed(2)))):r.a.createElement("div",null,"No data for selected period")))};function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=function(e){var t=Object(a.useState)(e),n=Object(Q.a)(t,2),r=n[0],c=n[1];return{data:r,setData:c,changeHandler:function(e){"number"===e.target.type&&c(oe({},r,Object(v.a)({},e.target.name,parseInt(e.target.value)))),c(oe({},r,Object(v.a)({},e.target.name,e.target.value)))}}},se=function(e){var t=e.children;return r.a.createElement("span",{className:"text-danger"},t)};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var pe={title:"",amount:void 0,expense_date:new Date},me=function(){var e=Object(a.useState)({}),t=Object(Q.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(!1),u=Object(Q.a)(l,2),i=u[0],p=u[1],m=ue(pe),f=m.data,h=m.setData,g=m.changeHandler,O=Object(o.b)(),y=Object(s.f)(),w=Object(o.c)((function(e){return!!e.token})),j=Object(o.c)((function(e){return e.user}));Object(a.useEffect)((function(){w||y.push("/")}),[]);return r.a.createElement("div",null,!!i&&r.a.createElement(Z.a,{variant:"success"},"New expense added"),r.a.createElement(ae.a,{onSubmit:function(e){e.preventDefault(),console.log("data",f),c({}),p(!1);var t=function(){var e={};return""===f.title.trim()&&(e.title="Required field"),void 0===f.amount&&(e.amount="Required field"),e}();if(0===Object.keys(t).length){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},f,{user:j});p(!0),O(function(e){return function(){var t=Object(b.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.addExpense(e);case 3:a=t.sent,n(q(a.data)),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(0),new Error("Unable to add");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(n)),h(pe)}else c(t)}},r.a.createElement(ae.a.Group,{controlId:"addExpense.title"},r.a.createElement(ae.a.Label,null,"Title ",r.a.createElement("span",{className:"text-danger"},"*")),r.a.createElement(ae.a.Control,{type:"text",placeholder:"Title",name:"title",value:f.title,onChange:function(e){return g(e)},isInvalid:!!n.title}),!!n.title&&r.a.createElement(se,null,n.title)),r.a.createElement(ae.a.Group,{controlId:"addExpense.amount"},r.a.createElement(ae.a.Label,null,"Amount ",r.a.createElement("span",{className:"text-danger"},"*")),r.a.createElement(ae.a.Control,{type:"number",placeholder:"Amount",name:"amount",value:!!f.amount&&f.amount,onChange:function(e){return g(e)},isInvalid:!!n.amount}),!!n.amount&&r.a.createElement(se,null,n.amount)),r.a.createElement(ae.a.Group,{controlId:"addExpense.date"},r.a.createElement(ae.a.Label,null,"Date:"),r.a.createElement(ae.a.Control,{type:"date",name:"expense_date",value:f.expense_date,onChange:function(e){return g(e)}})),r.a.createElement(E.a,{variant:"primary",type:"submit"},"Add")))},Ee=function(){return r.a.createElement(z,null,r.a.createElement($,{title:"Add expense"}),r.a.createElement(me,null))},fe=function(){var e=Object(a.useState)({}),t=Object(Q.a)(e,2),n=t[0],c=t[1],l=Object(s.f)(),u=ue({identifier:"",password:""}),i=u.data,p=u.changeHandler,m=Object(o.b)(),f=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m(R(i));case 4:l.push("/expenses"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),c({loginError:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,!!n.loginError&&r.a.createElement(Z.a,{variant:"danger"},n.loginError),r.a.createElement(ae.a,{onSubmit:f},r.a.createElement(ae.a.Group,{controlId:"login.username"},r.a.createElement(ae.a.Label,null,"Username"),r.a.createElement(ae.a.Control,{type:"text",placeholder:"Username",name:"identifier",value:i.identifier,onChange:function(e){return p(e)}})),r.a.createElement(ae.a.Group,{controlId:"login.password"},r.a.createElement(ae.a.Label,null,"Password"),r.a.createElement(ae.a.Control,{type:"password",placeholder:"Password",name:"password",value:i.password,onChange:function(e){return p(e)}})),r.a.createElement(E.a,{variant:"primary",type:"submit"},"Login")))},de=function(){return r.a.createElement(z,null,r.a.createElement($,{title:"Login"}),r.a.createElement(fe,null))},be={username:"",email:"",password:""},ve=function(){var e=Object(o.b)(),t=Object(a.useState)({}),n=Object(Q.a)(t,2),c=n[0],l=n[1],u=ue(be),s=u.data,i=u.changeHandler,p=function(){var t=Object(b.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,e(J(s));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),l({register:t.t0.toString().replace("Error: ","")});case 9:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,!!c.register&&r.a.createElement(Z.a,{variant:"danger"},c.register),r.a.createElement(ae.a,{onSubmit:p},r.a.createElement(ae.a.Group,{controlId:"signup.username"},r.a.createElement(ae.a.Label,null,"Username:"),r.a.createElement(ae.a.Control,{type:"text",placeholder:"Username",name:"username",value:s.username,onChange:function(e){return i(e)}})),r.a.createElement(ae.a.Group,{controlId:"signup.email"},r.a.createElement(ae.a.Label,null,"Email:"),r.a.createElement(ae.a.Control,{type:"email",placeholder:"Email",name:"email",value:s.email,onChange:function(e){return i(e)}})),r.a.createElement(ae.a.Group,{controlId:"signup.password"},r.a.createElement(ae.a.Label,null,"Password"),r.a.createElement(ae.a.Control,{type:"password",placeholder:"Password",name:"password",value:s.password,onChange:function(e){return i(e)}})),r.a.createElement(E.a,{variant:"primary",type:"submit"},"Sign up")))},he=function(){return r.a.createElement(z,null,r.a.createElement($,{title:"Sign Up"}),r.a.createElement(ve,null))};var ge=function(){return r.a.createElement("div",{className:"l-app"},r.a.createElement(o.a,{store:C},r.a.createElement(u.a,null,r.a.createElement(W,null),r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0,component:K}),r.a.createElement(s.a,{path:"/expenses",exact:!0,component:ce}),r.a.createElement(s.a,{path:"/expenses/new",exact:!0,component:Ee}),r.a.createElement(s.a,{path:"/login",exact:!0,component:de}),r.a.createElement(s.a,{path:"/register",exact:!0,component:he})),r.a.createElement(Y,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},80:function(e,t,n){e.exports=n(127)},85:function(e,t,n){},91:function(e,t,n){}},[[80,1,2]]]);
//# sourceMappingURL=main.a20ffceb.chunk.js.map